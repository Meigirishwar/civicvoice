<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Track Complaint ‚Äì Civic Voice</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #e0f2fe, #ffffff);
            min-height: 100vh;
        }

        .progress-container {
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 3rem 0;
        }

        .progress-line {
            position: absolute;
            top: 50%;
            left: 0;
            height: 6px;
            background-color: #d1d5db;
            width: 100%;
            transform: translateY(-50%);
            border-radius: 9999px;
        }

        .progress-line-fill {
            position: absolute;
            top: 50%;
            left: 0;
            height: 6px;
            background-color: #3b82f6;
            width: 0;
            transform: translateY(-50%);
            border-radius: 9999px;
            transition: width 1s ease-in-out;
        }

        .step {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #d1d5db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.25rem;
            transition: background-color 0.5s, transform 0.3s;
        }

        .step.active .step-circle {
            background-color: #3b82f6;
            transform: scale(1.1);
            box-shadow: 0 0 12px rgba(59,130,246,0.4);
        }

        .step.completed .step-circle {
            background-color: #16a34a;
            box-shadow: 0 0 12px rgba(22,163,74,0.4);
        }

        .step.rejected .step-circle {
            background-color: #dc2626;
            box-shadow: 0 0 12px rgba(220,38,38,0.4);
        }

        .step-label {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #374151;
            font-weight: 500;
        }
    </style>
</head>

<body class="text-gray-800">

<!-- Navbar -->
<nav class="bg-white shadow-md fixed top-0 w-full z-50 flex items-center justify-between px-8 py-4">
    <h1 class="text-2xl font-extrabold text-blue-700 tracking-tight flex items-center space-x-2">
        <i class="bi bi-megaphone-fill text-blue-600"></i>
        <span>Civic Voice</span>
    </h1>

    <div class="flex items-center space-x-4">
        <a href="/complaints/list" class="text-blue-600 font-semibold hover:underline flex items-center">
            <i class="bi bi-arrow-left-circle mr-1"></i> Back to My Complaints
        </a>
    </div>
</nav>

<!-- Main Section -->
<section class="pt-28 pb-12 px-6">
    <div class="max-w-3xl mx-auto glass-card bg-white rounded-2xl shadow-lg p-8">
        <h2 class="text-3xl font-bold text-blue-800 mb-6 text-center">üöÄ Track Complaint Progress</h2>

        <!-- Complaint Info -->
        <div class="text-center mb-6">
            <h3 class="text-xl font-semibold text-gray-800" th:text="${complaint.title}">Complaint Title</h3>
            <p class="text-gray-500 mt-1" th:text="${complaint.category}">Category</p>
            <p class="text-sm text-gray-400 mt-1">
                Filed on: <span th:text="${#temporals.format(complaint.dateCreated, 'dd MMM yyyy, hh:mm a')}"></span>
            </p>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-line"></div>
            <div class="progress-line-fill" id="progressFill"></div>

            <div class="step" id="step1">
                <div class="step-circle"><i class="bi bi-pencil-square"></i></div>
                <span class="step-label">Filed</span>
            </div>
            <div class="step" id="step2">
                <div class="step-circle"><i class="bi bi-hourglass-split"></i></div>
                <span class="step-label">In Progress</span>
            </div>
            <div class="step" id="step3">
                <div class="step-circle"><i class="bi bi-check2-circle"></i></div>
                <span class="step-label">Completed</span>
            </div>
        </div>

        <!-- Description -->
        <p class="text-gray-700 text-center mb-6" th:text="${complaint.description}">
            Description of your complaint...
        </p>

        <!-- Status Message -->
        <div class="text-center">
            <span th:if="${complaint.status.name().toLowerCase() == 'pending'}"
                  class="bg-yellow-100 text-yellow-700 px-4 py-2 rounded-full font-semibold">‚è≥ Pending Review</span>

            <span th:if="${complaint.status.name().toLowerCase() == 'in_progress'}"
                  class="bg-blue-100 text-blue-700 px-4 py-2 rounded-full font-semibold">üîß Work In Progress</span>

            <span th:if="${complaint.status.name().toLowerCase() == 'completed'}"
                  class="bg-green-100 text-green-700 px-4 py-2 rounded-full font-semibold">‚úÖ Complaint Resolved</span>

            <span th:if="${complaint.status.name().toLowerCase() == 'rejected'}"
                  class="bg-red-100 text-red-700 px-4 py-2 rounded-full font-semibold">‚ùå Complaint Rejected</span>
        </div>
    </div>
</section>

<footer class="text-center text-sm text-gray-500 py-6 border-t border-gray-200 mt-10">
    ¬© 2025 Civic Voice ‚Äî Empowering communities with technology üíô
</footer>

<!-- Animation Script -->
<script th:inline="javascript">
    const status = [[${complaint.status.name().toLowerCase()}]];
    const progressFill = document.getElementById("progressFill");
    const step1 = document.getElementById("step1");
    const step2 = document.getElementById("step2");
    const step3 = document.getElementById("step3");

    function activateSteps(completed) {
        [step1, step2, step3].forEach((step, index) => {
            if (index < completed) step.classList.add("completed");
            if (index === completed - 1) step.classList.add("active");
        });
    }

    if (status === "pending") {
        progressFill.style.width = "20%";
        activateSteps(1);
    } else if (status === "in_progress") {
        progressFill.style.width = "60%";
        activateSteps(2);
    } else if (status === "completed") {
        progressFill.style.width = "100%";
        activateSteps(3);
    } else if (status === "rejected") {
        progressFill.style.width = "100%";
        activateSteps(3);
        step3.classList.remove("completed");
        step3.classList.add("rejected");
    }
</script>

</body>
</html>
